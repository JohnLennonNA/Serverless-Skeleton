service: ElasticQuery
frameworkVersion: ">=1.0.0 <2.0.0"

provider:
  name: aws
  stage: ${opt:stage, 'homologation'}
  region: ${opt:region, 'sa-east-1'}
  runtime: python3.6
  deploymentBucket:
    name: services.lambda # Deployment bucket name. Default is generated by the framework

functions:
  ElasticQuery:
    name: ${self:service}
    description: "Search order's log on elastic"
    handler: exec.main
    memory: 128
    timeout: 20
    environment:
      URL_ELASTIC: ${file(../env.yml):${self:provider.stage}.URL_ELASTIC}
    events:
      - http:
          path: order/log/{idOrder}
          method: GET
      - cloudwatchLog:
          logGroup: /aws/lambda/${self:service}/${self:provider.stage}
    cors:
      - enabled: true

plugins:
  - serverless-plugin-simulate

custom:
  customDomain:
    domainName: "test"